# Blocked: Re-verification / E2E (2026-01-30)

## Task

Per PROMPT_build.md: re-verify one completed spec (all specs 001–004 marked complete). Chose spec 001 (Constants).

## Done

- Re-verified spec 001 acceptance criteria against `src/constants/networks.ts` and `src/constants/coins.ts`: ChainId enum (9 chains), networks array, ercTokens array, lookup objects, code style — all present.
- Added aria-labels to bridge Select triggers for e2e (From chain / To chain).
- Set Playwright `baseURL` and `webServer.url` so tests target the preview server.
- Installed Playwright browsers so e2e can run.

## Blockers

1. **Playwright: "test() to be called here"**  
   When running `playwright test` or `playwright test --list`, test files are loaded in a context where `currentlyLoadingFileSuite()` is null, so every `test()` call throws and no tests are registered. Occurs with and without webServer, with a minimal single-test file. Likely environment/version (e.g. `node_modules/.deno` has @playwright/test@1.58.0 vs pnpm 1.58.1) or loader/transform loading tests in the main process instead of a worker.

2. **Hydration (if e2e ran)**  
   With SSR on, client hydration fails: "Invalid source for live query: … alias \"network\" is not a Collection or subquery". So the app body ends up empty after load; e2e would not see h1 or form. Tried `ssr = false` for the page and adjusting e2e to wait for client render; then hit blocker 1.

3. **Unit (Deno)**  
   `pnpm test:unit` (deno task) fails: loading `src/collections/networks.ts` pulls in `@tanstack/svelte-db` and Deno reports "No \"exports\" main defined" for that package. Only `src/lib/voltaire.spec.ts` runs under Deno; collections specs cannot run without fixing Deno ↔ @tanstack/svelte-db resolution.

## Exit

Not outputting DONE. Spec 001 code is re-verified; full test pass (unit + e2e) is blocked by the above.

---

## Same-day retry (PROMPT_build)

- Again re-verified spec 001 by inspection: `networks.ts` and `coins.ts` satisfy all criteria (9 chains, lookups, style).
- **Unit:** `pnpm test:unit` fails: Deno reports "Failed resolving binary export" for `@tevm/voltaire` or `@sveltejs/kit` (node_modules/.deno layout). Running only collections specs fails on "@tanstack/query-core not in import map" (query-client.ts).
- **E2E:** `pnpm test:e2e` / `npx playwright test` fail: "Cannot find module 'playwright-core/lib/cli/program'" — resolution goes through node_modules/.deno and is broken.
- Conclusion: test environment (Deno-managed node_modules) blocks verification; no code change. Exit without phrase.
