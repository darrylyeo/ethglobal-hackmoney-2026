# Spec 035: Architecture diagram graph visualization (G6)

Create a G6-powered architecture diagram that explains how the app’s major
systems and data flows connect. The diagram should be a first-class page, with
clear labels, legend, and iconography, so contributors can understand the stack
and runtime dependencies at a glance.

## Scope

- **Route:** `src/routes/architecture/+page.svelte`
- **Graph component:** `src/components/ArchitectureGraph.svelte`
- **Diagram model:** `src/lib/architecture-graph.ts` (normalized nodes/edges)
- **Icons:** use existing chain icon pipeline in `scripts/_fetch-chain-icons.ts`
  and `static/networks`

## Diagram contents

### Core nodes

- **Client/UI:** SvelteKit app + Svelte 5 components
- **State:** TanStack DB collections
- **Blockchain access:** Voltaire RPC + ABI registry
- **Bridge/Swap:** LI.FI routes + quotes
- **USDC bridge:** Circle CCTP / Bridge Kit
- **Rooms:** PartyKit realtime rooms
- **Price/Oracle:** Stork price feeds
- **Payments/Channels:** Yellow state channels
- **Wallets:** EIP-1193 wallet connections
- **Networks:** supported chains (use chain icons)

### Core edges

- UI → State: collections read/write
- State → Voltaire: RPC calls, simulations, event queries
- State → LI.FI: route/quote requests
- State → Circle: CCTP transfers + status
- UI ↔ Wallets: chain switching + signing
- Rooms ↔ UI: realtime peer updates
- State ↔ Stork: price updates
- State ↔ Yellow: channel state updates
- Voltaire ↔ Networks: RPC access per chain
- Wallets ↔ Networks: transactions on chain

## Visual design

- Use a layered left-to-right layout (Client → State → Services → Networks).
- Nodes use distinct shapes per category: UI, state, service, network.
- Edges are directional with arrowheads and short labels (e.g. “quotes”, “RPC”).
- Provide a legend explaining colors/shapes and the chain icon usage.
- Highlight critical paths (bridge/swap) with stronger edge styling.

## Interactions

- Pan/zoom, drag-node, click-select, and fit-to-view.
- Hover shows node/edge metadata in a small details panel.
- Keyboard support: `+`/`-` zoom, arrows pan, `Escape` clears selection.
- Respect `prefers-reduced-motion` by disabling animations.

## Icon sourcing and attribution

- **Chains:** use `static/networks/{chainId}.svg` (or variants) generated by
  `scripts/_fetch-chain-icons.ts`.
- If a required chain icon is missing, add it to `chainIconItems` using the
  existing comment format that documents the official source URL and whether it
  came from explorer assets. Run `bun run icons` to fetch + optimize.
- **Non-chain icons:** prefer simple geometric shapes + labels; if brand icons
  are required later, follow the same process and attribution style in a new
  icon fetch script only if chain icons are insufficient.

## Acceptance criteria

- [ ] `ArchitectureGraph.svelte` renders the diagram with G6 and uses the
      normalized graph model from `architecture-graph.ts`.
- [ ] The architecture route renders the diagram with a short textual intro and
      a legend that explains node/edge styling.
- [ ] Nodes include all core systems listed above and are connected by the
      listed edges.
- [ ] The diagram uses chain icons from `static/networks` for network nodes.
- [ ] Pan/zoom, selection, hover details, and keyboard shortcuts work.
- [ ] Reduced motion is respected (no animated transitions).
- [ ] The diagram remains readable in both light and dark themes.

## TODOs

- TODO: Confirm the default chain set shown in the diagram.
- TODO: Decide if the diagram should be embedded on the home page as a preview.

## Status

Incomplete.

## Output when complete

`DONE`
